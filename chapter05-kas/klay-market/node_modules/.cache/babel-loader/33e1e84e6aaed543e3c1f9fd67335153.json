{"ast":null,"code":"import axios from \"axios\";\nimport { NFT_CONTRACT_ADDRESS } from \"../constants/index\";\nconst A2P_API_PREPAR_URL = \"https://a2a-api.klipwallet.com/v2/a2a/prepare\";\nconst APP_NAME = \"KLAY_MARKET\";\nexport const mintCardWithURI = async (toAddress, tokenId, uri, setQrvalue, callback) => {\n  const functionJSON = '{ \"constant\": false, \"inputs\": [ { \"name\": \"to\", \"type\": \"address\" }, { \"name\": \"tokenId\", \"type\": \"uint256\" }, { \"name\": \"tokenURI\", \"type\": \"string\" } ], \"name\": \"mintWithTokenURI\", \"outputs\": [ { \"name\": \"\", \"type\": \"bool\" } ], \"payable\": false, \"stateMutability\": \"nonpayable\", \"type\": \"function\" }';\n  executeContract(NFT_CONTRACT_ADDRESS, functionJSON, \"0\", `[\"${toAddress}\",\"${tokenId}\",\"${uri}\"]`, setQrvalue, callback);\n};\nexport const executeContract = (txTo, functionJSON, value, params, setQrvalue, callback) => {\n  axios.post(A2P_API_PREPAR_URL, {\n    bapp: {\n      name: APP_NAME\n    },\n    type: \"execute_contract\",\n    transaction: {\n      to: txTo,\n      abi: functionJSON,\n      value: value,\n      params: params\n    }\n  }).then(response => {\n    const {\n      request_key\n    } = response.data;\n    const qrcode = `https://klipwallet.com/?target=/a2a?request_key=${request_key}`;\n    setQrvalue(qrcode);\n    let timerId = setInterval(() => {\n      axios.get(`https://a2a-api.klipwallet.com/v2/a2a/result?request_key=${request_key}`).then(res => {\n        if (res.data.result) {\n          console.log(`[Result] (${JSON.stringify(res.data.result)}`);\n\n          if (res.data.result.status === 'sccess') {\n            clearInterval(timerId);\n            callback(res.data.result);\n          }\n        }\n      });\n    }, 1000);\n  });\n};\nexport const getAddress = (setQrvalue, callback) => {\n  axios.post(A2P_API_PREPAR_URL, {\n    bapp: {\n      name: APP_NAME\n    },\n    type: \"auth\"\n  }).then(response => {\n    const {\n      request_key\n    } = response.data;\n    const qrcode = `https://klipwallet.com/?target=/a2a?request_key=${request_key}`;\n    setQrvalue(qrcode);\n    let timerId = setInterval(() => {\n      axios.get(`https://a2a-api.klipwallet.com/v2/a2a/result?request_key=${request_key}`).then(res => {\n        if (res.data.result) {\n          console.log(`[Result] (${JSON.stringify(res.data.result)}`);\n          callback(res.data.result.klaytn_address);\n          clearInterval(timerId);\n        }\n      });\n    }, 1000);\n  });\n}; // export const setCount = (count, setQrvalue) => {\n// \taxios.post(\n// \t\tA2P_API_PREPAR_URL,{\n// \t\t\tbapp: {\n// \t\t\t\tname: APP_NAME\n// \t\t\t},\n// \t\t\ttype: \"execute_contract\",\n// \t\t\ttransaction: {\n// \t\t\t\tto: COUNT_CONTRACT_ADDRESS,\n// \t\t\t\tabi: '{ \"constant\": false, \"inputs\": [ { \"name\": \"_count\", \"type\": \"uint256\" } ], \"name\": \"setCount\", \"outputs\": [], \"payable\": false, \"stateMutability\": \"nonpayable\", \"type\": \"function\" }',\n// \t\t\t\tvalue: \"0\",\n// \t\t\t\tparams: `[\"${count}\"]`\n// \t\t\t}\n// \t\t}\n// \t).then((response) => {\n// \t\tconst {request_key} = response.data;\n// \t\tconst qrcode = `https://klipwallet.com/?target=/a2a?request_key=${request_key}`;\n// \t\tsetQrvalue(qrcode);\n// \t\tlet timerId = setInterval(() => {\n// \t\t\taxios.get(`https://a2a-api.klipwallet.com/v2/a2a/result?request_key=${request_key}`).then((res) => {\n// \t\t\t\tif (res.data.result) {\n// \t\t\t\t\tconsole.log(`[Result] (${JSON.stringify(res.data.result)}`);\n// \t\t\t\t\tif(res.data.result.status === 'sccess'){\n// \t\t\t\t\t\tclearInterval(timerId);\n// \t\t\t\t\t}\n// \t\t\t\t}\n// \t\t\t});\n// \t\t}, 1000)\n// \t});\n// }","map":{"version":3,"sources":["/workspace/ProjectLion_BlockCha/chapter05/klay-market/src/api/UseKlip.js"],"names":["axios","NFT_CONTRACT_ADDRESS","A2P_API_PREPAR_URL","APP_NAME","mintCardWithURI","toAddress","tokenId","uri","setQrvalue","callback","functionJSON","executeContract","txTo","value","params","post","bapp","name","type","transaction","to","abi","then","response","request_key","data","qrcode","timerId","setInterval","get","res","result","console","log","JSON","stringify","status","clearInterval","getAddress","klaytn_address"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport { NFT_CONTRACT_ADDRESS } from \"../constants/index\";\n\nconst A2P_API_PREPAR_URL = \"https://a2a-api.klipwallet.com/v2/a2a/prepare\";\nconst APP_NAME = \"KLAY_MARKET\";\n\nexport const mintCardWithURI = async (toAddress, tokenId, uri, setQrvalue, callback) =>{\n\tconst functionJSON = '{ \"constant\": false, \"inputs\": [ { \"name\": \"to\", \"type\": \"address\" }, { \"name\": \"tokenId\", \"type\": \"uint256\" }, { \"name\": \"tokenURI\", \"type\": \"string\" } ], \"name\": \"mintWithTokenURI\", \"outputs\": [ { \"name\": \"\", \"type\": \"bool\" } ], \"payable\": false, \"stateMutability\": \"nonpayable\", \"type\": \"function\" }';\n\texecuteContract(NFT_CONTRACT_ADDRESS, functionJSON, \"0\", `[\"${toAddress}\",\"${tokenId}\",\"${uri}\"]`, setQrvalue, callback);\n};\n\nexport const executeContract = (txTo, functionJSON, value, params, setQrvalue, callback) => {\n\taxios.post(\n\t\tA2P_API_PREPAR_URL,{\n\t\t\tbapp: {\n\t\t\t\tname: APP_NAME\n\t\t\t},\n\t\t\ttype: \"execute_contract\",\n\t\t\ttransaction: {\n\t\t\t\tto: txTo,\n\t\t\t\tabi: functionJSON,\n\t\t\t\tvalue: value,\n\t\t\t\tparams: params\n\t\t\t}\n\t\t}\n\t).then((response) => {\n\t\tconst {request_key} = response.data;\n\t\tconst qrcode = `https://klipwallet.com/?target=/a2a?request_key=${request_key}`;\n\t\tsetQrvalue(qrcode);\n\t\t\n\t\tlet timerId = setInterval(() => {\n\t\t\taxios.get(`https://a2a-api.klipwallet.com/v2/a2a/result?request_key=${request_key}`).then((res) => {\n\t\t\t\tif (res.data.result) {\n\t\t\t\t\tconsole.log(`[Result] (${JSON.stringify(res.data.result)}`);\n\t\t\t\t\tif(res.data.result.status === 'sccess'){\n\t\t\t\t\t\tclearInterval(timerId);\n\t\t\t\t\t\tcallback(res.data.result);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}, 1000)\n\t});\n};\n\n\nexport const getAddress = (setQrvalue, callback) => {\n\taxios.post(\n\t\tA2P_API_PREPAR_URL,{\n\t\t\tbapp: {\n\t\t\t\tname: APP_NAME\n\t\t\t},\n\t\t\ttype: \"auth\"\n\t\t}\n\t).then((response) => {\n\t\tconst {request_key} = response.data;\n\t\tconst qrcode = `https://klipwallet.com/?target=/a2a?request_key=${request_key}`;\n\t\tsetQrvalue(qrcode);\n\t\t\n\t\tlet timerId = setInterval(() => {\n\t\t\taxios.get(`https://a2a-api.klipwallet.com/v2/a2a/result?request_key=${request_key}`).then((res) => {\n\t\t\t\tif (res.data.result) {\n\t\t\t\t\tconsole.log(`[Result] (${JSON.stringify(res.data.result)}`);\n\t\t\t\t\tcallback(res.data.result.klaytn_address);\n\t\t\t\t\tclearInterval(timerId);\n\t\t\t\t}\n\t\t\t});\n\t\t}, 1000)\n\t})\n}\n\n// export const setCount = (count, setQrvalue) => {\n// \taxios.post(\n// \t\tA2P_API_PREPAR_URL,{\n// \t\t\tbapp: {\n// \t\t\t\tname: APP_NAME\n// \t\t\t},\n// \t\t\ttype: \"execute_contract\",\n// \t\t\ttransaction: {\n// \t\t\t\tto: COUNT_CONTRACT_ADDRESS,\n// \t\t\t\tabi: '{ \"constant\": false, \"inputs\": [ { \"name\": \"_count\", \"type\": \"uint256\" } ], \"name\": \"setCount\", \"outputs\": [], \"payable\": false, \"stateMutability\": \"nonpayable\", \"type\": \"function\" }',\n// \t\t\t\tvalue: \"0\",\n// \t\t\t\tparams: `[\"${count}\"]`\n// \t\t\t}\n// \t\t}\n// \t).then((response) => {\n// \t\tconst {request_key} = response.data;\n// \t\tconst qrcode = `https://klipwallet.com/?target=/a2a?request_key=${request_key}`;\n// \t\tsetQrvalue(qrcode);\n\t\t\n// \t\tlet timerId = setInterval(() => {\n// \t\t\taxios.get(`https://a2a-api.klipwallet.com/v2/a2a/result?request_key=${request_key}`).then((res) => {\n// \t\t\t\tif (res.data.result) {\n// \t\t\t\t\tconsole.log(`[Result] (${JSON.stringify(res.data.result)}`);\n// \t\t\t\t\tif(res.data.result.status === 'sccess'){\n// \t\t\t\t\t\tclearInterval(timerId);\n// \t\t\t\t\t}\n// \t\t\t\t}\n// \t\t\t});\n// \t\t}, 1000)\n// \t});\n// }"]},"metadata":{},"sourceType":"module"}